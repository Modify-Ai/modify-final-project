# AI íŒ¨ì…˜ ì¶”ì²œ ì‹œìŠ¤í…œ í™•ì¥ ê¸°ëŠ¥ ë°œí‘œ

**ë°œí‘œì**: [ì´ë¦„]
**ë°œí‘œ ì‹œê°„**: 10ë¶„
**ì£¼ì œ**: AI íŒ¨ì…˜ ì¶”ì²œ ì‹œìŠ¤í…œì˜ ì‚¬ìš©ì ê²½í—˜ ê°œì„  ë° ë©€í‹°ëª¨ë‹¬ í™•ì¥

---

## ğŸ“‹ ëª©ì°¨
1. [í”„ë¡œì íŠ¸ ê°œìš”](#1-í”„ë¡œì íŠ¸-ê°œìš”)
2. [êµ¬í˜„ ê¸°ëŠ¥ ì†Œê°œ](#2-êµ¬í˜„-ê¸°ëŠ¥-ì†Œê°œ)
3. [ê¸°ëŠ¥ë³„ ìƒì„¸ ì„¤ëª…](#3-ê¸°ëŠ¥ë³„-ìƒì„¸-ì„¤ëª…)
4. [í•µì‹¬ ê¸°ìˆ  ê°œë…](#4-í•µì‹¬-ê¸°ìˆ -ê°œë…)
5. [ë°ëª¨ ë° ê²°ê³¼](#5-ë°ëª¨-ë°-ê²°ê³¼)
6. [í–¥í›„ ê°œì„  ë°©í–¥](#6-í–¥í›„-ê°œì„ -ë°©í–¥)

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 ê¸°ì¡´ ì‹œìŠ¤í…œ
- CLIP + BERT ê¸°ë°˜ AI íŒ¨ì…˜ ê²€ìƒ‰ ì‹œìŠ¤í…œ
- í…ìŠ¤íŠ¸/ì´ë¯¸ì§€ ì¿¼ë¦¬ë¡œ ì˜ë¥˜ ìƒí’ˆ ê²€ìƒ‰
- Vector Similarity ê¸°ë°˜ ì¶”ì²œ

### 1.2 ê°œì„  ëª©í‘œ
- **ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘**: ê²€ìƒ‰ í’ˆì§ˆ ê°œì„ ì„ ìœ„í•œ ë°ì´í„° í™•ë³´
- **ê²€ìƒ‰ ì •ë°€ë„ í–¥ìƒ**: ì›í•˜ì§€ ì•ŠëŠ” ê²°ê³¼ í•„í„°ë§
- **ê²€ìƒ‰ ë°©ì‹ ë‹¤ì–‘í™”**: í–¥ìˆ˜/ìŒì•… ë“± ë¼ì´í”„ìŠ¤íƒ€ì¼ ê¸°ë°˜ ì¶”ì²œ

---

## 2. êµ¬í˜„ ê¸°ëŠ¥ ì†Œê°œ

### âœ… ê¸°ëŠ¥ 1: AI ê²€ìƒ‰ ê²°ê³¼ í”¼ë“œë°± ì‹œìŠ¤í…œ
- ì‚¬ìš©ìê°€ ê²€ìƒ‰ ê²°ê³¼ì— ì¢‹ì•„ìš”/ì‹«ì–´ìš” ë°˜ì‘ ê°€ëŠ¥
- ë¡œê·¸ì¸/ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì ëª¨ë‘ ì§€ì› (Session ID í™œìš©)
- ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì—ì„œ í”¼ë“œë°± í†µê³„ í™•ì¸

### âœ… ê¸°ëŠ¥ 2: ë„¤ê±°í‹°ë¸Œ í”„ë¡¬í”„íŠ¸ (Negative Prompt)
- ê²€ìƒ‰ ì‹œ ì œì™¸í•  í‚¤ì›Œë“œ ì…ë ¥ ê¸°ëŠ¥
- ì˜ˆ: "ì²­ë°”ì§€, ìŠ¤ë‹ˆì»¤ì¦ˆ, ìºì£¼ì–¼" ì…ë ¥ ì‹œ í•´ë‹¹ ì•„ì´í…œ ì œì™¸
- ê²€ìƒ‰ ê²°ê³¼ ì •ë°€ë„ í–¥ìƒ

### âœ… ê¸°ëŠ¥ 3: ë¬´ë“œ ê¸°ë°˜ ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰
- í–¥ìˆ˜ ë…¸íŠ¸ ë˜ëŠ” ìŒì•… ì¥ë¥´ ì…ë ¥ìœ¼ë¡œ íŒ¨ì…˜ ì¶”ì²œ
- ì˜ˆ: "í”Œë¡œëŸ´" â†’ ë¡œë§¨í‹±í•œ ì›í”¼ìŠ¤, "ì¬ì¦ˆ" â†’ ë¹ˆí‹°ì§€ ì¬í‚·
- 13ê°œ í–¥ìˆ˜ ë…¸íŠ¸ + 13ê°œ ìŒì•… ì¥ë¥´ ë§¤í•‘

---

## 3. ê¸°ëŠ¥ë³„ ìƒì„¸ ì„¤ëª…

---

### ğŸ¯ ê¸°ëŠ¥ 1: AI ê²€ìƒ‰ ê²°ê³¼ í”¼ë“œë°± ì‹œìŠ¤í…œ

#### 3.1.1 êµ¬í˜„ ë°°ê²½
- AI ê²€ìƒ‰ í’ˆì§ˆ ê°œì„ ì„ ìœ„í•´ì„œëŠ” **ì‚¬ìš©ì í”¼ë“œë°± ë°ì´í„°**ê°€ í•„ìˆ˜
- ì–´ë–¤ ê²€ìƒ‰ì–´ì— ì–´ë–¤ ìƒí’ˆì´ ì¢‹ì€/ë‚˜ìœ ê²°ê³¼ì¸ì§€ í•™ìŠµ í•„ìš”
- í–¥í›„ ê°•í™”í•™ìŠµ(RLHF) ì ìš© ê°€ëŠ¥í•œ ë°ì´í„° ìˆ˜ì§‘

#### 3.1.2 ê¸°ìˆ ì  ìš”êµ¬ì‚¬í•­
1. **ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì ì§€ì›**: Session IDë¡œ ì‚¬ìš©ì ì¶”ì 
2. **ê²€ìƒ‰ ë§¥ë½ ì €ì¥**: ì–´ë–¤ ê²€ìƒ‰ì–´ë¡œ ì°¾ì•˜ëŠ”ì§€ ê¸°ë¡
3. **ì‹¤ì‹œê°„ ë°˜ì˜**: ì¢‹ì•„ìš” í† ê¸€ ì‹œ ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸
4. **ê¶Œí•œ ê¸°ë°˜ í‘œì‹œ**: ì¼ë°˜ ì‚¬ìš©ìëŠ” ì¢‹ì•„ìš” ìˆ˜ë§Œ, ê´€ë¦¬ìëŠ” ì „ì²´ í†µê³„

#### 3.1.3 ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

**í…Œì´ë¸”: search_feedbacks**
```sql
CREATE TABLE search_feedbacks (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE SET NULL,  -- ë¡œê·¸ì¸ ì‚¬ìš©ì
    session_id VARCHAR(255),                                   -- ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì
    product_id INTEGER REFERENCES products(id) ON DELETE CASCADE,
    feedback_type VARCHAR(20) NOT NULL,  -- 'like' or 'dislike'
    search_query TEXT,                   -- ê²€ìƒ‰ì–´ ì €ì¥
    search_context JSON,                 -- ê²€ìƒ‰ ë©”íƒ€ë°ì´í„°
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_user_product ON search_feedbacks(user_id, product_id);
CREATE INDEX idx_session_product ON search_feedbacks(session_id, product_id);
CREATE INDEX idx_product ON search_feedbacks(product_id);
```

**ì£¼ìš” íŠ¹ì§•**:
- `user_id`ì™€ `session_id` ëª¨ë‘ nullable â†’ ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ ìˆìœ¼ë©´ ë¨
- `search_query` ì €ì¥ â†’ ì–´ë–¤ ê²€ìƒ‰ì—ì„œ ë‚˜ì˜¨ ê²°ê³¼ì¸ì§€ ì¶”ì 
- ë³µí•© ì¸ë±ìŠ¤ë¡œ "íŠ¹ì • ì‚¬ìš©ìì˜ íŠ¹ì • ìƒí’ˆ í”¼ë“œë°±" ë¹ ë¥´ê²Œ ì¡°íšŒ

#### 3.1.4 ë°±ì—”ë“œ êµ¬í˜„

**í•µì‹¬ ì½”ë“œ 1: Hybrid Authentication**
```python
# backend-core/src/api/v1/endpoints/feedback.py

async def get_user_or_session(
    request: Request,
    db: AsyncSession,
    x_session_id: Optional[str] = Header(None)
) -> tuple[Optional[int], Optional[str]]:
    """
    ì‚¬ìš©ì ì‹ë³„: JWT í† í° ìš°ì„ , ì—†ìœ¼ë©´ Session ID ì‚¬ìš©
    """
    # 1. Authorization í—¤ë”ì—ì„œ JWT í† í° í™•ì¸
    auth_header = request.headers.get("Authorization")
    if auth_header and auth_header.startswith("Bearer "):
        token = auth_header.replace("Bearer ", "")
        try:
            payload = jwt.decode(
                token,
                settings.JWT_SECRET_KEY,
                algorithms=[settings.ALGORITHM]
            )
            user_id = payload.get("sub")
            if user_id:
                return int(user_id), None  # ë¡œê·¸ì¸ ì‚¬ìš©ì
        except JWTError:
            pass

    # 2. JWT ì—†ìœ¼ë©´ Session ID ì‚¬ìš©
    return None, x_session_id  # ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì
```

**í•µì‹¬ ì½”ë“œ 2: í”¼ë“œë°± ì œì¶œ API**
```python
@router.post("/", response_model=FeedbackResponse)
async def submit_feedback(
    request: Request,
    feedback: FeedbackCreate,
    db: AsyncSession = Depends(deps.get_db),
    x_session_id: Optional[str] = Header(None)
):
    """í”¼ë“œë°± ì œì¶œ (ìƒì„± ë˜ëŠ” ì—…ë°ì´íŠ¸)"""
    user_id, session_id = await get_user_or_session(request, db, x_session_id)

    # ê¸°ì¡´ í”¼ë“œë°± ì¡°íšŒ
    query = select(SearchFeedback).where(
        SearchFeedback.product_id == feedback.product_id
    )
    if user_id:
        query = query.where(SearchFeedback.user_id == user_id)
    else:
        query = query.where(SearchFeedback.session_id == session_id)

    result = await db.execute(query)
    existing = result.scalar_one_or_none()

    if existing:
        # ê°™ì€ íƒ€ì…ì´ë©´ ì‚­ì œ (í† ê¸€), ë‹¤ë¥¸ íƒ€ì…ì´ë©´ ì—…ë°ì´íŠ¸
        if existing.feedback_type == feedback.feedback_type:
            await db.delete(existing)
            await db.commit()
            return {"status": "DELETED", "feedback": None}
        else:
            existing.feedback_type = feedback.feedback_type
            existing.search_query = feedback.search_query
            existing.updated_at = datetime.utcnow()
    else:
        # ìƒˆë¡œìš´ í”¼ë“œë°± ìƒì„±
        new_feedback = SearchFeedback(
            user_id=user_id,
            session_id=session_id,
            product_id=feedback.product_id,
            feedback_type=feedback.feedback_type,
            search_query=feedback.search_query,
            search_context=feedback.search_context
        )
        db.add(new_feedback)

    await db.commit()
    return {"status": "SUCCESS", "feedback": existing or new_feedback}
```

#### 3.1.5 í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„

**í•µì‹¬ ì½”ë“œ 1: Session ID ê´€ë¦¬**
```typescript
// frontend/src/utils/session.ts

const SESSION_KEY = 'guest_session_id';

export function generateUUID(): string {
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {
    const r = Math.random() * 16 | 0;
    const v = c === 'x' ? r : (r & 0x3 | 0x8);
    return v.toString(16);
  });
}

export function getOrCreateSessionId(): string {
  let sessionId = localStorage.getItem(SESSION_KEY);
  if (!sessionId) {
    sessionId = generateUUID();
    localStorage.setItem(SESSION_KEY, sessionId);
  }
  return sessionId;
}
```

**í•µì‹¬ ì½”ë“œ 2: Axios ì¸í„°ì…‰í„°**
```typescript
// frontend/src/api/client.ts

client.interceptors.request.use((config) => {
  const { token } = useAuthStore.getState();

  if (token) {
    // ë¡œê·¸ì¸ ì‚¬ìš©ì: JWT í† í° ì „ì†¡
    config.headers.Authorization = `Bearer ${token}`;
  } else {
    // ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì: Session ID ì „ì†¡
    const sessionId = getOrCreateSessionId();
    config.headers['X-Session-Id'] = sessionId;
  }

  return config;
});
```

**í•µì‹¬ ì½”ë“œ 3: í”¼ë“œë°± ë²„íŠ¼ ì»´í¬ë„ŒíŠ¸**
```tsx
// frontend/src/components/product/FeedbackButtons.tsx

export default function FeedbackButtons({ productId }: Props) {
  const { user } = useAuthStore();
  const isAdmin = user?.role === 'admin';

  const [stats, setStats] = useState<FeedbackStats | null>(null);
  const [myFeedback, setMyFeedback] = useState<string | null>(null);

  // í”¼ë“œë°± ì œì¶œ
  const handleFeedback = async (type: 'like' | 'dislike') => {
    try {
      const response = await feedbackAPI.submit({
        product_id: productId,
        feedback_type: type,
      });

      if (response.status === 'DELETED') {
        setMyFeedback(null);  // í† ê¸€ë¡œ ì·¨ì†Œë¨
      } else {
        setMyFeedback(type);
      }

      fetchStats();  // í†µê³„ ìƒˆë¡œê³ ì¹¨
    } catch (error) {
      console.error('í”¼ë“œë°± ì œì¶œ ì‹¤íŒ¨:', error);
    }
  };

  return (
    <div className="flex items-center space-x-4">
      {/* ì¢‹ì•„ìš” ë²„íŠ¼ (ëª¨ë“  ì‚¬ìš©ì) */}
      <button
        onClick={() => handleFeedback('like')}
        className={myFeedback === 'like' ? 'text-blue-600' : 'text-gray-400'}
      >
        <ThumbsUp className="w-5 h-5" />
        <span>{stats?.like_count || 0}</span>
      </button>

      {/* ì‹«ì–´ìš” ë²„íŠ¼ (ê´€ë¦¬ìë§Œ) */}
      {isAdmin && (
        <button
          onClick={() => handleFeedback('dislike')}
          className={myFeedback === 'dislike' ? 'text-red-600' : 'text-gray-400'}
        >
          <ThumbsDown className="w-5 h-5" />
          <span>{stats?.dislike_count || 0}</span>
        </button>
      )}
    </div>
  );
}
```

#### 3.1.6 ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ

```tsx
// frontend/src/pages/admin/Dashboard.tsx

// ìµœê·¼ í”¼ë“œë°± 20ê°œ í‘œì‹œ
const [recentFeedback, setRecentFeedback] = useState([]);

useEffect(() => {
  feedbackAPI.getRecent(20).then(setRecentFeedback);
}, []);

return (
  <table>
    <thead>
      <tr>
        <th>ìƒí’ˆ ID</th>
        <th>í”¼ë“œë°±</th>
        <th>ê²€ìƒ‰ì–´</th>
        <th>ì‚¬ìš©ì</th>
        <th>ì‹œê°„</th>
      </tr>
    </thead>
    <tbody>
      {recentFeedback.map((fb) => (
        <tr key={fb.id}>
          <td>{fb.product_id}</td>
          <td>{fb.feedback_type === 'like' ? 'ğŸ‘' : 'ğŸ‘'}</td>
          <td>{fb.search_query || '-'}</td>
          <td>{fb.user_id || `Guest ${fb.session_id.slice(0, 8)}`}</td>
          <td>{new Date(fb.created_at).toLocaleString()}</td>
        </tr>
      ))}
    </tbody>
  </table>
);
```

---

### ğŸš« ê¸°ëŠ¥ 2: ë„¤ê±°í‹°ë¸Œ í”„ë¡¬í”„íŠ¸ (Negative Prompt)

#### 3.2.1 êµ¬í˜„ ë°°ê²½
- AI ì´ë¯¸ì§€ ìƒì„±(Stable Diffusion ë“±)ì—ì„œ ì‚¬ìš©ë˜ëŠ” ê°œë…
- "ì›í•˜ëŠ” ê²ƒ"ë¿ë§Œ ì•„ë‹ˆë¼ "ì›í•˜ì§€ ì•ŠëŠ” ê²ƒ"ë„ ëª…ì‹œ
- ê²€ìƒ‰ ì •ë°€ë„ í–¥ìƒ: ë¶ˆí•„ìš”í•œ ê²°ê³¼ ì œê±°

**ì˜ˆì‹œ**:
- ê²€ìƒ‰: "ì—¬ë¦„ ì½”ë””"
- ë„¤ê±°í‹°ë¸Œ: "ì²­ë°”ì§€, ìŠ¤ë‹ˆì»¤ì¦ˆ, ìºì£¼ì–¼"
- ê²°ê³¼: ì²­ë°”ì§€/ìŠ¤ë‹ˆì»¤ì¦ˆê°€ ì•„ë‹Œ ì—¬ë¦„ ì˜· ì¶”ì²œ

#### 3.2.2 ê¸°ìˆ  êµ¬í˜„

**í•µì‹¬ ì½”ë“œ 1: í‚¤ì›Œë“œ ì¶”ì¶œ**
```python
# backend-core/src/api/v1/endpoints/search.py

import re
from typing import List, Optional

def extract_negative_keywords(negative_prompt: Optional[str]) -> List[str]:
    """
    ë„¤ê±°í‹°ë¸Œ í”„ë¡¬í”„íŠ¸ì—ì„œ ì œì™¸í•  í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸ ì¶”ì¶œ

    ì§€ì› êµ¬ë¶„ì: ì‰¼í‘œ(,), ìŠ¬ë˜ì‹œ(/), ê³µë°±
    ì˜ˆ: "ì²­ë°”ì§€, ìŠ¤ë‹ˆì»¤ì¦ˆ/ìºì£¼ì–¼ ë°ë‹˜" â†’ ["ì²­ë°”ì§€", "ìŠ¤ë‹ˆì»¤ì¦ˆ", "ìºì£¼ì–¼", "ë°ë‹˜"]
    """
    if not negative_prompt:
        return []

    # ì •ê·œì‹ìœ¼ë¡œ ì—¬ëŸ¬ êµ¬ë¶„ì ì²˜ë¦¬
    keywords = re.split(r'[,/\s]+', negative_prompt.strip())

    # ê³µë°± ì œê±° ë° ì†Œë¬¸ì ë³€í™˜
    return [k.strip().lower() for k in keywords if k.strip()]
```

**í•µì‹¬ ì½”ë“œ 2: ìƒí’ˆ í•„í„°ë§**
```python
def filter_products_by_negative(
    products: List[Product],
    negative_keywords: List[str]
) -> List[Product]:
    """
    ë„¤ê±°í‹°ë¸Œ í‚¤ì›Œë“œë¥¼ í¬í•¨í•˜ëŠ” ìƒí’ˆ ì œì™¸

    ê²€ì‚¬ ëŒ€ìƒ: ìƒí’ˆëª…, ì„¤ëª…, ì¹´í…Œê³ ë¦¬
    """
    if not negative_keywords:
        return products

    filtered = []
    for product in products:
        # ìƒí’ˆ ì •ë³´ë¥¼ í•˜ë‚˜ì˜ í…ìŠ¤íŠ¸ë¡œ ê²°í•©
        text_to_check = (
            f"{product.name} "
            f"{product.description or ''} "
            f"{product.category or ''}"
        ).lower()

        # ë„¤ê±°í‹°ë¸Œ í‚¤ì›Œë“œê°€ í•˜ë‚˜ë¼ë„ í¬í•¨ë˜ë©´ ì œì™¸
        contains_negative = any(
            keyword in text_to_check
            for keyword in negative_keywords
        )

        if not contains_negative:
            filtered.append(product)

    return filtered
```

**í•µì‹¬ ì½”ë“œ 3: ê²€ìƒ‰ API í†µí•©**
```python
@router.post("/hybrid", response_model=Dict[str, Any])
async def hybrid_search(
    query: str = Form(...),
    negative_prompt: Optional[str] = Form(None),  # âœ… ì¶”ê°€
    image: Optional[UploadFile] = File(None),
    limit: int = Form(20),
    db: AsyncSession = Depends(deps.get_db),
):
    # 1. AI ê²€ìƒ‰ ìˆ˜í–‰ (CLIP + BERT)
    products = await perform_ai_search(query, image, limit * 2, db)

    # 2. ë„¤ê±°í‹°ë¸Œ í•„í„°ë§ ì ìš©
    negative_keywords = extract_negative_keywords(negative_prompt)
    products = filter_products_by_negative(products, negative_keywords)

    # 3. ìµœì¢… ê²°ê³¼ ë°˜í™˜
    return {
        "status": "SUCCESS",
        "products": products[:limit],
        "negative_applied": bool(negative_keywords),
        "filtered_keywords": negative_keywords
    }
```

#### 3.2.3 í”„ë¡ íŠ¸ì—”ë“œ UI

```tsx
// frontend/src/pages/Search.tsx

const [negativePrompt, setNegativePrompt] = useState('');

// ê²€ìƒ‰ ìš”ì²­ ì‹œ negative_prompt í¬í•¨
const handleSearch = async () => {
  const formData = new FormData();
  formData.append('query', searchQuery);
  formData.append('negative_prompt', negativePrompt);  // âœ… ì¶”ê°€

  const results = await searchAPI.hybrid(formData);
  setProducts(results.products);
};

return (
  <div>
    {/* ê¸°ë³¸ ê²€ìƒ‰ì°½ */}
    <input
      type="text"
      value={searchQuery}
      onChange={(e) => setSearchQuery(e.target.value)}
      placeholder="ì›í•˜ëŠ” ìŠ¤íƒ€ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"
    />

    {/* ë„¤ê±°í‹°ë¸Œ í”„ë¡¬í”„íŠ¸ ì…ë ¥ */}
    <div className="flex items-center space-x-3 mt-3">
      <X className="w-5 h-5 text-red-400" />
      <input
        type="text"
        value={negativePrompt}
        onChange={(e) => setNegativePrompt(e.target.value)}
        placeholder="ì œì™¸í•  ìŠ¤íƒ€ì¼ (ì˜ˆ: ì²­ë°”ì§€, ìŠ¤ë‹ˆì»¤ì¦ˆ, ìºì£¼ì–¼)"
        className="flex-1 text-sm border rounded px-3 py-2"
      />
    </div>
  </div>
);
```

#### 3.2.4 ê°œë… ì„¤ëª…: Negative Promptë€?

**ì •ì˜**:
- Generative AIì—ì„œ **ì›í•˜ì§€ ì•ŠëŠ” ìš”ì†Œë¥¼ ëª…ì‹œ**í•˜ëŠ” ê¸°ë²•
- Positive Prompt(ì›í•˜ëŠ” ê²ƒ) + Negative Prompt(ì›í•˜ì§€ ì•ŠëŠ” ê²ƒ)

**í™œìš© ì˜ˆì‹œ**:
1. **ì´ë¯¸ì§€ ìƒì„± AI** (Stable Diffusion):
   - Positive: "beautiful landscape, sunset, mountains"
   - Negative: "people, cars, buildings, text"

2. **íŒ¨ì…˜ ê²€ìƒ‰** (ë³¸ í”„ë¡œì íŠ¸):
   - Positive: "ì—¬ë¦„ ì½”ë””"
   - Negative: "ì²­ë°”ì§€, ìŠ¤ë‹ˆì»¤ì¦ˆ, ìºì£¼ì–¼"

**ê¸°ìˆ ì  ì°¨ì´**:
- AI ì´ë¯¸ì§€ ìƒì„±: ëª¨ë¸ ë ˆë²¨ì—ì„œ ë„¤ê±°í‹°ë¸Œ ì„ë² ë”© ì ìš©
- ë³¸ í”„ë¡œì íŠ¸: ê²€ìƒ‰ í›„ **í›„ì²˜ë¦¬ í•„í„°ë§** ë°©ì‹ (ê°„ë‹¨í•˜ê³  íš¨ê³¼ì )

---

### ğŸµ ê¸°ëŠ¥ 3: ë¬´ë“œ ê¸°ë°˜ ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰

#### 3.3.1 êµ¬í˜„ ë°°ê²½
- íŒ¨ì…˜ì€ **ë¼ì´í”„ìŠ¤íƒ€ì¼**ê³¼ ë°€ì ‘í•œ ì—°ê´€
- "ì˜¤ëŠ˜ í”Œë¡œëŸ´ í–¥ìˆ˜ ë¿Œë ¸ëŠ”ë° ì–´ìš¸ë¦¬ëŠ” ì˜·ì€?"
- "ì¬ì¦ˆ ì½˜ì„œíŠ¸ ê°€ëŠ”ë° ë­ ì…ì§€?"
- **Synesthesia(ê³µê°ê°)**: í–¥/ì†Œë¦¬ â†’ ì‹œê°ì  ìŠ¤íƒ€ì¼ ì—°ê²°

#### 3.3.2 ë¬´ë“œ ë§¤í•‘ ì‹œìŠ¤í…œ ì„¤ê³„

**í–¥ìˆ˜ ë…¸íŠ¸ â†’ íŒ¨ì…˜ ìŠ¤íƒ€ì¼ ë§¤í•‘**
```python
# backend-core/src/utils/mood_mapper.py

PERFUME_MOOD_MAP: Dict[str, Dict[str, any]] = {
    "í”Œë¡œëŸ´": {
        "keywords": ["ë¡œë§¨í‹±", "í˜ë¯¸ë‹Œ", "ì›í”¼ìŠ¤", "í”Œë¼ì›Œ", "íŒŒìŠ¤í…”", "í™”ì´íŠ¸"],
        "colors": ["í•‘í¬", "í™”ì´íŠ¸", "ë¼ë²¤ë”", "ë² ì´ì§€"],
        "style": "ë¡œë§¨í‹±, í˜ë¯¸ë‹Œ",
        "mood": "ë¶€ë“œëŸ½ê³  ìš°ì•„í•œ",
        "negative": ["ìŠ¤í¬ì¸ ", "ìºì£¼ì–¼", "ë°ë‹˜"]
    },
    "ìš°ë””": {
        "keywords": ["í´ë˜ì‹", "ì •ì¥", "íŠ¸ë Œì¹˜ì½”íŠ¸", "ë² ì´ì§€", "ë¸Œë¼ìš´", "ê°€ì£½"],
        "colors": ["ë¸Œë¼ìš´", "ë² ì´ì§€", "ì¹´í‚¤", "ë¸”ë™"],
        "style": "í´ë˜ì‹, ì‹œí¬",
        "mood": "ì°¨ë¶„í•˜ê³  ì„¸ë ¨ëœ",
        "negative": ["ë„¤ì˜¨", "ìŠ¤í¬í‹°", "ìºì£¼ì–¼"]
    },
    "ì‹œíŠ¸ëŸ¬ìŠ¤": {
        "keywords": ["í”„ë ˆì‹œ", "í™”ì´íŠ¸", "ë¦°ë„¨", "ì—¬ë¦„", "ë¹„ì¹˜", "ë°ì€"],
        "colors": ["í™”ì´íŠ¸", "ì˜ë¡œìš°", "ìŠ¤ì¹´ì´ë¸”ë£¨", "ë¯¼íŠ¸"],
        "style": "í”„ë ˆì‹œ, ìºì£¼ì–¼",
        "mood": "ìƒì¾Œí•˜ê³  í™œê¸°ì°¬",
        "negative": ["ë‹¤í¬", "í—¤ë¹„", "ê²¨ìš¸"]
    },
    # ... ì´ 13ê°œ í–¥ìˆ˜ ë…¸íŠ¸
}
```

**ìŒì•… ì¥ë¥´ â†’ íŒ¨ì…˜ ìŠ¤íƒ€ì¼ ë§¤í•‘**
```python
MUSIC_MOOD_MAP: Dict[str, Dict[str, any]] = {
    "ì¬ì¦ˆ": {
        "keywords": ["ë¹ˆí‹°ì§€", "ë ˆíŠ¸ë¡œ", "ì¬í‚·", "ëª¨ì", "ë¸Œë¼ìš´", "í´ë˜ì‹"],
        "colors": ["ë¸Œë¼ìš´", "ë² ì´ì§€", "ë²„ê±´ë””", "ë¸”ë™"],
        "style": "ë¹ˆí‹°ì§€, í´ë˜ì‹",
        "mood": "ì„¸ë ¨ë˜ê³  ìš°ì•„í•œ",
        "negative": ["ìŠ¤í¬í‹°", "ë„¤ì˜¨", "ìŠ¤íŠ¸ë¦¿"]
    },
    "í™í•©": {
        "keywords": ["ìŠ¤íŠ¸ë¦¿", "ì˜¤ë²„ì‚¬ì´ì¦ˆ", "í›„ë“œ", "ìŠ¤ë‹ˆì»¤ì¦ˆ", "ë°ë‹˜", "ë¡œê³ "],
        "colors": ["ë¸”ë™", "í™”ì´íŠ¸", "ê·¸ë ˆì´", "ë ˆë“œ"],
        "style": "ìŠ¤íŠ¸ë¦¿, ìºì£¼ì–¼",
        "mood": "ììœ ë¡­ê³  í™í•œ",
        "negative": ["ì •ì¥", "í˜ë¯¸ë‹Œ", "í´ë˜ì‹"]
    },
    "í´ë˜ì‹": {
        "keywords": ["ì •ì¥", "ìˆ˜íŠ¸", "ë“œë ˆìŠ¤", "ë¸”ë™", "í™”ì´íŠ¸", "ìš°ì•„"],
        "colors": ["ë¸”ë™", "í™”ì´íŠ¸", "ë„¤ì´ë¹„", "ë²„ê±´ë””"],
        "style": "í¬ë©€, ìš°ì•„",
        "mood": "ê³ ê¸‰ìŠ¤ëŸ½ê³  í’ˆê²©ìˆëŠ”",
        "negative": ["ìºì£¼ì–¼", "ìŠ¤í¬í‹°", "ì»¬ëŸ¬í’€"]
    },
    # ... ì´ 13ê°œ ìŒì•… ì¥ë¥´
}
```

#### 3.3.3 í‚¤ì›Œë“œ ì¶”ì¶œ ë¡œì§

```python
def extract_mood_keywords(query: str) -> Dict[str, Any]:
    """
    ì‚¬ìš©ì ì…ë ¥ì—ì„œ ë¬´ë“œ ì •ë³´ ì¶”ì¶œ

    Returns:
        {
            "type": "perfume" | "music" | "unknown",
            "mood": "í”Œë¡œëŸ´" | "ì¬ì¦ˆ" | None,
            "data": { ë§¤í•‘ ë°ì´í„° } | None
        }
    """
    query_lower = query.lower().strip()

    # 1. í–¥ìˆ˜ ë…¸íŠ¸ ê²€ìƒ‰
    for note, data in PERFUME_MOOD_MAP.items():
        if note in query_lower:
            return {
                "type": "perfume",
                "mood": note,
                "data": data
            }

    # 2. ìŒì•… ì¥ë¥´ ê²€ìƒ‰
    for genre, data in MUSIC_MOOD_MAP.items():
        if genre in query_lower:
            return {
                "type": "music",
                "mood": genre,
                "data": data
            }

    # 3. ë§¤ì¹­ ì‹¤íŒ¨
    return {
        "type": "unknown",
        "mood": None,
        "data": None
    }
```

#### 3.3.4 ê²€ìƒ‰ ì¿¼ë¦¬ ìƒì„±

```python
def build_mood_search_query(mood_data: Dict[str, Any]) -> str:
    """
    ë¬´ë“œ ë°ì´í„°ë¥¼ AI ê²€ìƒ‰ ì¿¼ë¦¬ë¡œ ë³€í™˜

    ì˜ˆ: "í”Œë¡œëŸ´" â†’ "ë¡œë§¨í‹± í˜ë¯¸ë‹Œ ì›í”¼ìŠ¤ í”Œë¼ì›Œ íŒŒìŠ¤í…” í™”ì´íŠ¸ í•‘í¬"
    """
    if not mood_data or mood_data["type"] == "unknown":
        return ""

    data = mood_data["data"]

    # í‚¤ì›Œë“œ + ìƒ‰ìƒ ê²°í•©
    keywords = data.get("keywords", [])
    colors = data.get("colors", [])

    query_parts = keywords + colors
    return " ".join(query_parts)
```

#### 3.3.5 ë¬´ë“œ ê²€ìƒ‰ API

```python
@router.post("/mood-search", response_model=Dict[str, Any])
async def mood_search(
    query: str = Form(..., description="í–¥ìˆ˜ ë…¸íŠ¸ ë˜ëŠ” ìŒì•… ì¥ë¥´"),
    limit: int = Form(12),
    db: AsyncSession = Depends(deps.get_db),
) -> Any:
    """
    ë¬´ë“œ ê¸°ë°˜ íŒ¨ì…˜ ê²€ìƒ‰

    ì‚¬ìš© ì˜ˆ:
    - query="í”Œë¡œëŸ´" â†’ ë¡œë§¨í‹±í•œ ì˜· ì¶”ì²œ
    - query="ì¬ì¦ˆ" â†’ ë¹ˆí‹°ì§€ ìŠ¤íƒ€ì¼ ì¶”ì²œ
    """
    from src.utils.mood_mapper import extract_mood_keywords, build_mood_search_query

    # 1. ë¬´ë“œ í‚¤ì›Œë“œ ì¶”ì¶œ
    mood_data = extract_mood_keywords(query)

    if mood_data["type"] == "unknown":
        raise HTTPException(
            status_code=400,
            detail=f"ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¬´ë“œì…ë‹ˆë‹¤: {query}"
        )

    # 2. AI ê²€ìƒ‰ ì¿¼ë¦¬ ìƒì„±
    search_query = build_mood_search_query(mood_data)

    # 3. AI ê²€ìƒ‰ ìˆ˜í–‰ (CLIP + BERT)
    products = await perform_ai_search(search_query, None, limit * 2, db)

    # 4. ë„¤ê±°í‹°ë¸Œ í•„í„°ë§ (ë¬´ë“œì— ë§ì§€ ì•ŠëŠ” ìŠ¤íƒ€ì¼ ì œê±°)
    negative_keywords = mood_data["data"].get("negative", [])
    products = filter_products_by_negative(products, negative_keywords)

    # 5. ê²°ê³¼ ë°˜í™˜
    return {
        "status": "SUCCESS",
        "mood_info": {
            "type": mood_data["type"],
            "mood": mood_data["mood"],
            "style": mood_data["data"]["style"],
            "mood_description": mood_data["data"]["mood"],
            "colors": mood_data["data"]["colors"]
        },
        "products": [product_to_dict(p) for p in products[:limit]]
    }
```

#### 3.3.6 í”„ë¡ íŠ¸ì—”ë“œ UI

**ë¬´ë“œ ê²€ìƒ‰ í˜ì´ì§€ êµ¬ì¡°**
```tsx
// frontend/src/pages/MoodSearch.tsx

export default function MoodSearch() {
  const [activeTab, setActiveTab] = useState<'perfume' | 'music'>('perfume');
  const [query, setQuery] = useState('');
  const [moodInfo, setMoodInfo] = useState<MoodInfo | null>(null);
  const [products, setProducts] = useState<Product[]>([]);

  // í–¥ìˆ˜ ë…¸íŠ¸ ì˜ˆì‹œ ë²„íŠ¼
  const perfumeExamples = [
    'í”Œë¡œëŸ´', 'ë¡œì¦ˆ', 'ìš°ë””', 'ì‹œíŠ¸ëŸ¬ìŠ¤', 'ì˜¤ë¦¬ì—”íƒˆ', 'ì•„ì¿ ì•„'
  ];

  // ìŒì•… ì¥ë¥´ ì˜ˆì‹œ ë²„íŠ¼
  const musicExamples = [
    'ì¬ì¦ˆ', 'í™í•©', 'í´ë˜ì‹', 'íŒ', 'ë½', 'ì¸ë””'
  ];

  const handleSearch = async () => {
    try {
      const formData = new FormData();
      formData.append('query', query);

      const response = await searchAPI.moodSearch(formData);
      setMoodInfo(response.mood_info);
      setProducts(response.products);
    } catch (error) {
      console.error('ë¬´ë“œ ê²€ìƒ‰ ì‹¤íŒ¨:', error);
    }
  };

  return (
    <div>
      {/* íƒ­: í–¥ìˆ˜ vs ìŒì•… */}
      <div className="flex border-b">
        <button
          onClick={() => setActiveTab('perfume')}
          className={activeTab === 'perfume' ? 'border-b-2 border-blue-500' : ''}
        >
          ğŸŒ¸ í–¥ìˆ˜ ë…¸íŠ¸
        </button>
        <button
          onClick={() => setActiveTab('music')}
          className={activeTab === 'music' ? 'border-b-2 border-blue-500' : ''}
        >
          ğŸµ ìŒì•… ì¥ë¥´
        </button>
      </div>

      {/* ê²€ìƒ‰ì°½ */}
      <div className="my-6">
        <input
          type="text"
          value={query}
          onChange={(e) => setQuery(e.target.value)}
          placeholder={
            activeTab === 'perfume'
              ? "í–¥ìˆ˜ ë…¸íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: í”Œë¡œëŸ´, ìš°ë””)"
              : "ìŒì•… ì¥ë¥´ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì¬ì¦ˆ, í™í•©)"
          }
        />
        <button onClick={handleSearch}>ê²€ìƒ‰</button>
      </div>

      {/* ë¹ ë¥¸ ê²€ìƒ‰ ë²„íŠ¼ */}
      <div className="flex flex-wrap gap-2 mb-8">
        {(activeTab === 'perfume' ? perfumeExamples : musicExamples).map((item) => (
          <button
            key={item}
            onClick={() => {
              setQuery(item);
              handleSearch();
            }}
            className="px-4 py-2 bg-gray-100 rounded-full hover:bg-gray-200"
          >
            {item}
          </button>
        ))}
      </div>

      {/* ë¬´ë“œ ì •ë³´ í‘œì‹œ */}
      {moodInfo && (
        <div className="bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg mb-8">
          <h3 className="text-xl font-bold mb-3">
            {moodInfo.type === 'perfume' ? 'ğŸŒ¸' : 'ğŸµ'} {moodInfo.mood}
          </h3>
          <p className="text-gray-700 mb-2">
            <strong>ìŠ¤íƒ€ì¼:</strong> {moodInfo.style}
          </p>
          <p className="text-gray-700 mb-2">
            <strong>ë¶„ìœ„ê¸°:</strong> {moodInfo.mood_description}
          </p>
          <div className="flex items-center gap-2">
            <strong>ì¶”ì²œ ì»¬ëŸ¬:</strong>
            {moodInfo.colors.map((color) => (
              <span
                key={color}
                className="px-3 py-1 bg-white rounded-full text-sm"
              >
                {color}
              </span>
            ))}
          </div>
        </div>
      )}

      {/* ìƒí’ˆ ê·¸ë¦¬ë“œ */}
      <div className="grid grid-cols-4 gap-6">
        {products.map((product) => (
          <ProductCard key={product.id} product={product} />
        ))}
      </div>
    </div>
  );
}
```

#### 3.3.7 ê°œë… ì„¤ëª…: ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰ì´ë€?

**ì •ì˜**:
- ì—¬ëŸ¬ ê°ê° ì–‘ì‹(Modality)ì„ í™œìš©í•œ ê²€ìƒ‰
- ë³¸ í”„ë¡œì íŠ¸: í…ìŠ¤íŠ¸/ì´ë¯¸ì§€ â†’ **í–¥ìˆ˜/ìŒì•…** ì¶”ê°€

**ëª¨ë‹¬ë¦¬í‹° ì¢…ë¥˜**:
1. **í…ìŠ¤íŠ¸**: "ì—¬ë¦„ ì›í”¼ìŠ¤"
2. **ì´ë¯¸ì§€**: ì˜· ì‚¬ì§„ ì—…ë¡œë“œ
3. **í–¥ìˆ˜ ë…¸íŠ¸**: "í”Œë¡œëŸ´" â†’ ë¡œë§¨í‹±í•œ ì˜·
4. **ìŒì•… ì¥ë¥´**: "ì¬ì¦ˆ" â†’ ë¹ˆí‹°ì§€ ìŠ¤íƒ€ì¼

**ê¸°ìˆ ì  ì ‘ê·¼**:
- **ì§ì ‘ ë©€í‹°ëª¨ë‹¬ í•™ìŠµ**: í–¥ìˆ˜/ìŒì•… ë°ì´í„°ë¡œ ëª¨ë¸ í›ˆë ¨ (ì–´ë ¤ì›€, ë°ì´í„° ë¶€ì¡±)
- **ë§¤í•‘ ê¸°ë°˜** (ë³¸ í”„ë¡œì íŠ¸): í–¥ìˆ˜/ìŒì•… â†’ íŒ¨ì…˜ í‚¤ì›Œë“œ ë³€í™˜ â†’ ê¸°ì¡´ AI ê²€ìƒ‰ í™œìš©

**ì¥ì **:
- ê°„ë‹¨í•˜ê³  íš¨ê³¼ì 
- ë„ë©”ì¸ ì§€ì‹ í™œìš© (íŒ¨ì…˜ ì „ë¬¸ê°€ì˜ ìŠ¤íƒ€ì¼ë§ ê·œì¹™)
- ë°ì´í„° ì—†ì´ ì¦‰ì‹œ ì ìš© ê°€ëŠ¥

---

## 4. í•µì‹¬ ê¸°ìˆ  ê°œë…

### 4.1 Hybrid Authentication (í•˜ì´ë¸Œë¦¬ë“œ ì¸ì¦)

**ê°œë…**:
- ë¡œê·¸ì¸/ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì ëª¨ë‘ ì§€ì›í•˜ëŠ” ì¸ì¦ ì‹œìŠ¤í…œ
- JWT(ë¡œê·¸ì¸) + Session ID(ë¹„ë¡œê·¸ì¸) ë™ì‹œ ìš´ì˜

**êµ¬í˜„ ë°©ì‹**:
```
1. ìš”ì²­ ìˆ˜ì‹ 
2. Authorization í—¤ë” í™•ì¸
   - JWT ìˆìŒ â†’ ì‚¬ìš©ì ID ì¶”ì¶œ â†’ DB user_id ì €ì¥
   - JWT ì—†ìŒ â†’ X-Session-Id í—¤ë” í™•ì¸ â†’ session_id ì €ì¥
3. ë‘˜ ë‹¤ ì—†ìœ¼ë©´ â†’ ì—ëŸ¬
```

**ì™œ í•„ìš”í•œê°€?**:
- ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ìë„ í”¼ë“œë°± ê°€ëŠ¥ â†’ ë” ë§ì€ ë°ì´í„° ìˆ˜ì§‘
- ë‚˜ì¤‘ì— íšŒì›ê°€ì… ì‹œ Session ID â†’ User ID ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ëŠ¥

---

### 4.2 Negative Filtering (ë„¤ê±°í‹°ë¸Œ í•„í„°ë§)

**ê°œë…**:
- AI ìƒì„± ëª¨ë¸ì˜ Negative Prompt ê°œë…ì„ ê²€ìƒ‰ì— ì ìš©
- ê²€ìƒ‰ ê²°ê³¼ì—ì„œ **ì›í•˜ì§€ ì•ŠëŠ” ìš”ì†Œ ì œê±°**

**êµ¬í˜„ ë°©ì‹**:
1. AI ê²€ìƒ‰ìœ¼ë¡œ í›„ë³´ ìƒí’ˆ ì¶”ì¶œ (limit * 2)
2. ê° ìƒí’ˆì˜ name/description/category í…ìŠ¤íŠ¸ ê²€ì‚¬
3. ë„¤ê±°í‹°ë¸Œ í‚¤ì›Œë“œ í¬í•¨ ì‹œ ì œì™¸
4. ë‚¨ì€ ìƒí’ˆ ì¤‘ limitê°œ ë°˜í™˜

**ì‹œê°„ ë³µì¡ë„**:
- O(N Ã— M): N = ìƒí’ˆ ìˆ˜, M = ë„¤ê±°í‹°ë¸Œ í‚¤ì›Œë“œ ìˆ˜
- ì‹¤ì œë¡œëŠ” N â‰¤ 40, M â‰¤ 5 â†’ ì¶©ë¶„íˆ ë¹ ë¦„

---

### 4.3 Mood Mapping (ë¬´ë“œ ë§¤í•‘)

**ê°œë…**:
- **ê³µê°ê°ì  ì—°ê²°**: í–¥/ì†Œë¦¬ â†’ ì‹œê°(íŒ¨ì…˜)
- ë„ë©”ì¸ ì§€ì‹ì„ Dictionaryë¡œ ì½”ë“œí™”

**ì„¤ê³„ ì›ì¹™**:
1. **ëª…í™•ì„±**: ê° ë¬´ë“œë§ˆë‹¤ ëª…í™•í•œ í‚¤ì›Œë“œ ì§‘í•©
2. **ì¼ê´€ì„±**: style, mood, colors êµ¬ì¡° í†µì¼
3. **í™•ì¥ì„±**: ìƒˆë¡œìš´ í–¥ìˆ˜/ìŒì•… ì‰½ê²Œ ì¶”ê°€ ê°€ëŠ¥

**ë°ì´í„° êµ¬ì¡°**:
```python
{
    "ë¬´ë“œëª…": {
        "keywords": [],      # AI ê²€ìƒ‰ì— ì‚¬ìš©
        "colors": [],        # UI í‘œì‹œìš©
        "style": "",         # ìŠ¤íƒ€ì¼ ìš”ì•½
        "mood": "",          # ë¶„ìœ„ê¸° ì„¤ëª…
        "negative": []       # ì œì™¸í•  ìŠ¤íƒ€ì¼
    }
}
```

---

### 4.4 Vector Similarity Search (ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰)

**ë³¸ í”„ë¡œì íŠ¸ì˜ AI ê²€ìƒ‰ ì›ë¦¬**:
```
1. ì‚¬ìš©ì ì…ë ¥ â†’ CLIP/BERT ëª¨ë¸ â†’ ë²¡í„°(512ì°¨ì›)
2. DBì˜ ëª¨ë“  ìƒí’ˆ â†’ ë¯¸ë¦¬ ê³„ì‚°ëœ ë²¡í„°
3. Cosine Similarity ê³„ì‚° â†’ ê°€ì¥ ê°€ê¹Œìš´ ìƒí’ˆ ë°˜í™˜
```

**ë¬´ë“œ ê²€ìƒ‰ì—ì„œì˜ í™œìš©**:
```
"í”Œë¡œëŸ´" ì…ë ¥
â†’ "ë¡œë§¨í‹± í˜ë¯¸ë‹Œ ì›í”¼ìŠ¤ íŒŒìŠ¤í…” í™”ì´íŠ¸ í•‘í¬"ë¡œ ë³€í™˜
â†’ BERT ì„ë² ë”©
â†’ ë²¡í„° ê²€ìƒ‰
â†’ ë¡œë§¨í‹±í•œ ì˜· ì¶”ì²œ
```

---

## 5. ë°ëª¨ ë° ê²°ê³¼

### 5.1 í”¼ë“œë°± ì‹œìŠ¤í…œ

**ì‹œë‚˜ë¦¬ì˜¤ 1: ë¡œê·¸ì¸ ì‚¬ìš©ì**
1. ìƒí’ˆ ê²€ìƒ‰: "ì—¬ë¦„ ì›í”¼ìŠ¤"
2. ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ ì§„ì…
3. ì¢‹ì•„ìš” ë²„íŠ¼ í´ë¦­
4. DB ì €ì¥: `user_id=123, product_id=456, feedback_type='like', search_query='ì—¬ë¦„ ì›í”¼ìŠ¤'`
5. ë‹¤ì‹œ í´ë¦­ ì‹œ ì¢‹ì•„ìš” ì·¨ì†Œ (í† ê¸€)

**ì‹œë‚˜ë¦¬ì˜¤ 2: ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì**
1. localStorageì— Session ID ìƒì„±: `abc123-def456...`
2. ìƒí’ˆ ì¢‹ì•„ìš” í´ë¦­
3. DB ì €ì¥: `session_id='abc123...', product_id=456, feedback_type='like'`
4. ë¸Œë¼ìš°ì € ë‹«ê³  ë‹¤ì‹œ ì—´ì–´ë„ ê°™ì€ Session ID â†’ í”¼ë“œë°± ìœ ì§€

**ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ**:
- ìµœê·¼ í”¼ë“œë°± 20ê°œ ì‹¤ì‹œê°„ í‘œì‹œ
- ì–´ë–¤ ê²€ìƒ‰ì–´ë¡œ ì–´ë–¤ ìƒí’ˆì´ ì¢‹ì•„ìš”/ì‹«ì–´ìš” ë°›ì•˜ëŠ”ì§€ í™•ì¸
- AI ëª¨ë¸ ê°œì„ ì„ ìœ„í•œ ë°ì´í„°ë¡œ í™œìš© ê°€ëŠ¥

---

### 5.2 ë„¤ê±°í‹°ë¸Œ í”„ë¡¬í”„íŠ¸

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 1**:
- ê²€ìƒ‰: "ë°ì¼ë¦¬ë£©"
- ë„¤ê±°í‹°ë¸Œ: "ì²­ë°”ì§€"
- ê²°ê³¼: ì²­ë°”ì§€ ì œì™¸ëœ ë°ì¼ë¦¬ë£© ì¶”ì²œ (ìŠ¬ë™ìŠ¤, ìŠ¤ì»¤íŠ¸ ë“±)

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 2**:
- ê²€ìƒ‰: "ìš´ë™ë³µ"
- ë„¤ê±°í‹°ë¸Œ: "ê²€ì •, í°ìƒ‰"
- ê²°ê³¼: ì»¬ëŸ¬í’€í•œ ìš´ë™ë³µë§Œ í‘œì‹œ

**íš¨ê³¼**:
- ê²€ìƒ‰ ì •ë°€ë„ í–¥ìƒ
- ì‚¬ìš©ì ë§Œì¡±ë„ ì¦ê°€ (ì›í•˜ëŠ” ê²ƒë§Œ ë³¼ ìˆ˜ ìˆìŒ)

---

### 5.3 ë¬´ë“œ ê¸°ë°˜ ê²€ìƒ‰

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 1: í–¥ìˆ˜ â†’ íŒ¨ì…˜**
- ì…ë ¥: "í”Œë¡œëŸ´"
- ë¬´ë“œ ì •ë³´:
  - ìŠ¤íƒ€ì¼: ë¡œë§¨í‹±, í˜ë¯¸ë‹Œ
  - ë¶„ìœ„ê¸°: ë¶€ë“œëŸ½ê³  ìš°ì•„í•œ
  - ì¶”ì²œ ì»¬ëŸ¬: í•‘í¬, í™”ì´íŠ¸, ë¼ë²¤ë”
- ê²°ê³¼: ì›í”¼ìŠ¤, ë¸”ë¼ìš°ìŠ¤, íŒŒìŠ¤í…” ì»¬ëŸ¬ ì˜ë¥˜

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 2: ìŒì•… â†’ íŒ¨ì…˜**
- ì…ë ¥: "ì¬ì¦ˆ"
- ë¬´ë“œ ì •ë³´:
  - ìŠ¤íƒ€ì¼: ë¹ˆí‹°ì§€, í´ë˜ì‹
  - ë¶„ìœ„ê¸°: ì„¸ë ¨ë˜ê³  ìš°ì•„í•œ
  - ì¶”ì²œ ì»¬ëŸ¬: ë¸Œë¼ìš´, ë² ì´ì§€, ë²„ê±´ë””
- ê²°ê³¼: ì¬í‚·, ëª¨ì, ë¹ˆí‹°ì§€ ìŠ¤íƒ€ì¼ ì˜ë¥˜

**ì‚¬ìš©ì í”¼ë“œë°±** (ê°€ìƒ):
- "í–¥ìˆ˜ë‘ ì–´ìš¸ë¦¬ëŠ” ì˜· ì°¾ê¸° ì¬ë¯¸ìˆì–´ìš”!"
- "ì¬ì¦ˆ ì½˜ì„œíŠ¸ ê°ˆ ë•Œ ì…ì„ ì˜· ë°”ë¡œ ì°¾ì•˜ì–´ìš”"

---

## 6. í–¥í›„ ê°œì„  ë°©í–¥

### 6.1 í”¼ë“œë°± ì‹œìŠ¤í…œ ê³ ë„í™”

**ë¨¸ì‹ ëŸ¬ë‹ í†µí•©**:
```python
# ê°•í™”í•™ìŠµ(RLHF) ì ìš© ì˜ˆì‹œ
def train_with_feedback(model, feedbacks):
    positive_samples = [f for f in feedbacks if f.type == 'like']
    negative_samples = [f for f in feedbacks if f.type == 'dislike']

    # ì¢‹ì•„ìš”ë°›ì€ ê²€ìƒ‰-ìƒí’ˆ ìŒ ê°•í™”
    for fb in positive_samples:
        reward = +1.0
        model.update(fb.search_query, fb.product, reward)

    # ì‹«ì–´ìš”ë°›ì€ ê²€ìƒ‰-ìƒí’ˆ ìŒ í˜ë„í‹°
    for fb in negative_samples:
        reward = -1.0
        model.update(fb.search_query, fb.product, reward)
```

**A/B í…ŒìŠ¤íŠ¸**:
- í”¼ë“œë°± ë°ì´í„°ë¡œ ëª¨ë¸ ì¬í›ˆë ¨
- ìƒˆ ëª¨ë¸ vs ê¸°ì¡´ ëª¨ë¸ ì„±ëŠ¥ ë¹„êµ
- í”¼ë“œë°± ì¦ê°€ìœ¨, ê²€ìƒ‰ ë§Œì¡±ë„ ì¸¡ì •

---

### 6.2 ë„¤ê±°í‹°ë¸Œ í”„ë¡¬í”„íŠ¸ ê³ ë„í™”

**í˜„ì¬ í•œê³„**:
- ë‹¨ìˆœ í‚¤ì›Œë“œ ë§¤ì¹­ (ì •í™•ë„ ì œí•œ)
- "ì²­ë°”ì§€"ëŠ” ì œì™¸ë˜ì§€ë§Œ "denim"ì€ í†µê³¼

**ê°œì„  ë°©ì•ˆ**:
1. **ì‹œë§¨í‹± í•„í„°ë§**:
   ```python
   # BERT ì„ë² ë”©ìœ¼ë¡œ ì˜ë¯¸ì  ìœ ì‚¬ë„ ê²€ì‚¬
   negative_embedding = bert_model.encode("ì²­ë°”ì§€")
   product_embedding = bert_model.encode(product.description)

   similarity = cosine_similarity(negative_embedding, product_embedding)
   if similarity > 0.8:  # ë§¤ìš° ìœ ì‚¬í•˜ë©´ ì œì™¸
       filter_out = True
   ```

2. **ì¹´í…Œê³ ë¦¬ ê¸°ë°˜ í•„í„°ë§**:
   - "ì²­ë°”ì§€" ì…ë ¥ ì‹œ â†’ category='denim' ìƒí’ˆ ëª¨ë‘ ì œì™¸

---

### 6.3 ë¬´ë“œ ë§¤í•‘ í™•ì¥

**ì¶”ê°€ ëª¨ë‹¬ë¦¬í‹°**:
1. **ë‚ ì”¨**: "ë¹„ì˜¤ëŠ” ë‚ " â†’ íŠ¸ë Œì¹˜ì½”íŠ¸, ìš°ì‚°
2. **ì¥ì†Œ**: "íšŒì‚¬" â†’ ì •ì¥, "ì¹´í˜" â†’ ìºì£¼ì–¼
3. **ê°ì •**: "ê¸°ë¶„ ì¢‹ì€ ë‚ " â†’ ë°ì€ ìƒ‰ìƒ, "ì°¨ë¶„í•œ ë‚ " â†’ ë² ì´ì§

**ìë™ ë§¤í•‘ ìƒì„±**:
```python
# GPT-4ë¥¼ í™œìš©í•œ ìë™ ë¬´ë“œ ë§¤í•‘ ìƒì„±
prompt = f"""
í–¥ìˆ˜ ë…¸íŠ¸ '{perfume_note}'ì— ì–´ìš¸ë¦¬ëŠ” íŒ¨ì…˜ ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”.
ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ë‹µë³€:
- í‚¤ì›Œë“œ:
- ìƒ‰ìƒ:
- ìŠ¤íƒ€ì¼:
- ë¶„ìœ„ê¸°:
"""

response = openai.ChatCompletion.create(
    model="gpt-4",
    messages=[{"role": "user", "content": prompt}]
)

auto_mapping = parse_response(response)
```

---

### 6.4 ì„±ëŠ¥ ìµœì í™”

**í˜„ì¬ ì„±ëŠ¥**:
- ê²€ìƒ‰ ì‘ë‹µ ì‹œê°„: ~500ms (AI ë²¡í„° ê²€ìƒ‰ í¬í•¨)
- ë„¤ê±°í‹°ë¸Œ í•„í„°ë§: ~10ms (40ê°œ ìƒí’ˆ ê¸°ì¤€)

**ê°œì„  ë°©ì•ˆ**:
1. **ë²¡í„° ì¸ë±ì‹±**: pgvector HNSW ì¸ë±ìŠ¤ ì ìš©
2. **ìºì‹±**: ìì£¼ ê²€ìƒ‰ë˜ëŠ” ë¬´ë“œ ê²°ê³¼ Redis ìºì‹±
3. **ë°°ì¹˜ ì²˜ë¦¬**: ì—¬ëŸ¬ ìƒí’ˆ ë™ì‹œ í•„í„°ë§

```python
# Redis ìºì‹± ì˜ˆì‹œ
@cache(ttl=3600)  # 1ì‹œê°„ ìºì‹±
async def mood_search(query: str):
    # ... ê²€ìƒ‰ ë¡œì§
    return results
```

---

## 7. ë§ˆë¬´ë¦¬

### 7.1 í•µì‹¬ ìš”ì•½

**êµ¬í˜„í•œ 3ê°€ì§€ ê¸°ëŠ¥**:
1. âœ… **í”¼ë“œë°± ì‹œìŠ¤í…œ**: ë¡œê·¸ì¸/ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì ëª¨ë‘ ê²€ìƒ‰ ê²°ê³¼ í‰ê°€ ê°€ëŠ¥
2. âœ… **ë„¤ê±°í‹°ë¸Œ í”„ë¡¬í”„íŠ¸**: ì›í•˜ì§€ ì•ŠëŠ” ì•„ì´í…œ ì œì™¸í•˜ì—¬ ê²€ìƒ‰ ì •ë°€ë„ í–¥ìƒ
3. âœ… **ë¬´ë“œ ê¸°ë°˜ ê²€ìƒ‰**: í–¥ìˆ˜/ìŒì•… ì…ë ¥ìœ¼ë¡œ íŒ¨ì…˜ ì¶”ì²œ (ë©€í‹°ëª¨ë‹¬ í™•ì¥)

**ì ìš©ëœ í•µì‹¬ ê¸°ìˆ **:
- Hybrid Authentication (JWT + Session ID)
- Vector Similarity Search (CLIP + BERT)
- Negative Filtering (í›„ì²˜ë¦¬ ê¸°ë°˜)
- Mood Mapping (ê³µê°ê°ì  ë§¤í•‘)

**ê¸°ëŒ€ íš¨ê³¼**:
- ì‚¬ìš©ì ê²½í—˜ ê°œì„  (ë” ì •í™•í•œ ê²€ìƒ‰, ë‹¤ì–‘í•œ ê²€ìƒ‰ ë°©ì‹)
- ë°ì´í„° ìˆ˜ì§‘ (í”¼ë“œë°± â†’ ëª¨ë¸ ê°œì„  ì„ ìˆœí™˜)
- ì°¨ë³„í™”ëœ ì„œë¹„ìŠ¤ (í–¥ìˆ˜/ìŒì•… ê¸°ë°˜ íŒ¨ì…˜ ì¶”ì²œ)

---

### 7.2 ì°¸ê³  ìë£Œ

**ê¸°ìˆ  ë¬¸ì„œ**:
- FastAPI: https://fastapi.tiangolo.com/
- SQLAlchemy 2.0: https://docs.sqlalchemy.org/
- React + TypeScript: https://react.dev/

**ê´€ë ¨ ë…¼ë¬¸/ê¸°ìˆ **:
- CLIP: "Learning Transferable Visual Models From Natural Language Supervision" (OpenAI, 2021)
- BERT: "BERT: Pre-training of Deep Bidirectional Transformers" (Google, 2018)
- Negative Prompt: Stable Diffusion ê³µì‹ ë¬¸ì„œ

**í”„ë¡œì íŠ¸ ì €ì¥ì†Œ**:
- GitHub: [ì €ì¥ì†Œ URL]
- ì»¤ë°‹ íˆìŠ¤í† ë¦¬: ê° ê¸°ëŠ¥ë³„ ì»¤ë°‹ ë©”ì‹œì§€ ì°¸ê³ 

---

### 7.3 Q&A ì˜ˆìƒ ì§ˆë¬¸

**Q1: Session IDê°€ íƒˆì·¨ë˜ë©´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?**
A: Session IDëŠ” ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ìì˜ **ì„ì‹œ ì‹ë³„ì**ì¼ ë¿, ë¯¼ê°í•œ ì •ë³´ëŠ” í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìµœì•…ì˜ ê²½ìš° ë‹¤ë¥¸ ì‚¬ëŒì˜ í”¼ë“œë°±ì´ ë‚´ ê²ƒìœ¼ë¡œ ê¸°ë¡ë  ìˆ˜ ìˆì§€ë§Œ, íšŒì› ì •ë³´ë‚˜ ê²°ì œ ì •ë³´ëŠ” ì—°ê²°ë˜ì§€ ì•Šì•„ ë³´ì•ˆ ìœ„í—˜ì€ ë‚®ìŠµë‹ˆë‹¤. ì¶”ê°€ë¡œ IP ê²€ì¦, Rate Limiting ë“±ì„ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**Q2: ë„¤ê±°í‹°ë¸Œ í”„ë¡¬í”„íŠ¸ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ ê²°ê³¼ê°€ ì—†ì„ ìˆ˜ë„ ìˆì§€ ì•Šë‚˜ìš”?**
A: ë§ìŠµë‹ˆë‹¤. ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´:
1. ìµœëŒ€ 5ê°œ í‚¤ì›Œë“œ ì œí•œ
2. í•„í„°ë§ í›„ ê²°ê³¼ê°€ 3ê°œ ë¯¸ë§Œì´ë©´ ê²½ê³  ë©”ì‹œì§€ í‘œì‹œ
3. "í•„í„°ë¥¼ ì™„í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?" ì˜µì…˜ ì œê³µ

**Q3: ë¬´ë“œ ë§¤í•‘ ë°ì´í„°ëŠ” ì–´ë–»ê²Œ ë§Œë“¤ì—ˆë‚˜ìš”?**
A: íŒ¨ì…˜ ì „ë¬¸ê°€ì˜ ì¡°ì–¸ê³¼ ì˜¨ë¼ì¸ ìŠ¤íƒ€ì¼ë§ ê°€ì´ë“œë¥¼ ì°¸ê³ í•˜ì—¬ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. í–¥í›„ ì‹¤ì œ ì‚¬ìš©ì í”¼ë“œë°±ì„ ìˆ˜ì§‘í•˜ì—¬ ìë™ìœ¼ë¡œ ê°œì„ í•  ì˜ˆì •ì…ë‹ˆë‹¤.

**Q4: AI ëª¨ë¸ ì¬í›ˆë ¨ì€ ì–¸ì œ í•˜ë‚˜ìš”?**
A: í˜„ì¬ëŠ” í”¼ë“œë°± ìˆ˜ì§‘ ë‹¨ê³„ì…ë‹ˆë‹¤. í”¼ë“œë°± ë°ì´í„°ê°€ 1,000ê°œ ì´ìƒ ìŒ“ì´ë©´ ì˜¤í”„ë¼ì¸ì—ì„œ ì¬í›ˆë ¨ í›„ A/B í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•  ê³„íšì…ë‹ˆë‹¤.

**Q5: ì™œ ë‹¨ìˆœ í‚¤ì›Œë“œ ë§¤ì¹­ì„ ì‚¬ìš©í–ˆë‚˜ìš”? ë” ê³ ê¸‰ ê¸°ìˆ ì€ ì—†ë‚˜ìš”?**
A: ì´ˆê¸° í”„ë¡œí† íƒ€ì…ì—ì„œëŠ” **ë‹¨ìˆœí•˜ê³  íš¨ê³¼ì ì¸** ë°©ë²•ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤. ì‹œë§¨í‹± í•„í„°ë§(BERT ì„ë² ë”©)ì€ ë” ì •í™•í•˜ì§€ë§Œ ì—°ì‚° ë¹„ìš©ì´ ë†’ì•„, ì‚¬ìš©ì ìˆ˜ê°€ ì¦ê°€í•˜ë©´ ì ìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.

---

## ğŸ“ ë¶€ë¡: ì£¼ìš” ì½”ë“œ íŒŒì¼ ëª©ë¡

### Backend
- `backend-core/src/models/search_feedback.py`: í”¼ë“œë°± DB ëª¨ë¸
- `backend-core/src/api/v1/endpoints/feedback.py`: í”¼ë“œë°± API (5ê°œ ì—”ë“œí¬ì¸íŠ¸)
- `backend-core/src/api/v1/endpoints/search.py`: ê²€ìƒ‰ API (ë„¤ê±°í‹°ë¸Œ + ë¬´ë“œ)
- `backend-core/src/utils/mood_mapper.py`: ë¬´ë“œ ë§¤í•‘ ì‹œìŠ¤í…œ
- `backend-core/alembic/versions/f1a2b3c4d5e6_*.py`: í”¼ë“œë°± í…Œì´ë¸” ë§ˆì´ê·¸ë ˆì´ì…˜

### Frontend
- `frontend/src/components/product/FeedbackButtons.tsx`: í”¼ë“œë°± UI ì»´í¬ë„ŒíŠ¸
- `frontend/src/pages/ProductDetail.tsx`: ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ (í”¼ë“œë°± í†µí•©)
- `frontend/src/pages/Search.tsx`: ê²€ìƒ‰ í˜ì´ì§€ (ë„¤ê±°í‹°ë¸Œ í”„ë¡¬í”„íŠ¸)
- `frontend/src/pages/MoodSearch.tsx`: ë¬´ë“œ ê²€ìƒ‰ í˜ì´ì§€
- `frontend/src/pages/admin/Dashboard.tsx`: ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ (í”¼ë“œë°± í†µê³„)
- `frontend/src/utils/session.ts`: Session ID ê´€ë¦¬
- `frontend/src/api/feedback.ts`: í”¼ë“œë°± API í´ë¼ì´ì–¸íŠ¸
- `frontend/src/api/client.ts`: Axios ì¸í„°ì…‰í„° (í•˜ì´ë¸Œë¦¬ë“œ ì¸ì¦)

---

**ë°œí‘œ ì¤€ë¹„ ì™„ë£Œ! ğŸ‰**
